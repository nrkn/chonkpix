import { assrtPositive } from '../util.js';
export const generateGridLayout = (cellW, cellH, cols, rows, gap = 0, padding = 0, dx = 0, dy = 0) => {
    const cellCount = cols * rows;
    const data = Array(cellCount);
    const width = measureCells(cellW, cols, gap, padding);
    const height = measureCells(cellH, rows, gap, padding);
    let x = padding;
    let y = padding;
    for (let i = 0; i < cellCount; i++) {
        data[i] = [x + dx, y + dy];
        x += cellW + gap;
        if (x + cellW > width) {
            x = padding;
            y += cellH + gap;
        }
    }
    return {
        cellW, cellH, cols, rows, gap, padding, width, height, cells: data
    };
};
export const measureCells = (size, count, gap = 0, padding = 0) => size * count + (count - 1) * gap + 2 * padding;
export const generateNamedGridLayout = (grid) => {
    const named = {
        ...grid
    };
    for (let y = 0; y < grid.rows; y++) {
        for (let x = 0; x < grid.cols; x++) {
            named[gridKey(x, y)] = grid.cells[y * grid.cols + x];
        }
    }
    return named;
};
export const colKey = (col) => {
    col = assrtPositive(col | 0, 'Only positive integers are allowed for column keys');
    let key = '';
    do {
        const mod = col % 26;
        key = String.fromCharCode(97 + mod) + key;
        col = Math.floor(col / 26) - 1;
    } while (col >= 0);
    return key;
};
export const parseColKey = (key) => {
    if (key.length === 0)
        return 0;
    if (key.length === 1)
        return key.charCodeAt(0) - 97;
    let col = 0;
    for (let i = 0; i < key.length - 1; i++) {
        col = col * 26 + (key.charCodeAt(i) - 97 + 1);
    }
    col = col * 26 + (key.charCodeAt(key.length - 1) - 97);
    return col;
};
export const gridKey = (col, row) => `${colKey(col)}${row}`;
export const parseGridKey = (gridKey) => {
    const match = gridKey.match(/^([a-z]+)(\d+)$/);
    if (!match) {
        throw Error(`Invalid grid key: ${gridKey}`);
    }
    const [, col, row] = match;
    return [parseColKey(col), parseInt(row)];
};
export const countCells = (avail, each, gap = 0, padding = 0) => {
    // remove the padding and add the final gap
    const inside = avail + gap - 2 * padding;
    return Math.floor(inside / (each + gap));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2dyaWQvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUcxQyxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyxDQUNoQyxLQUFhLEVBQUUsS0FBYSxFQUM1QixJQUFZLEVBQUUsSUFBWSxFQUMxQixHQUFHLEdBQUcsQ0FBQyxFQUFFLE9BQU8sR0FBRyxDQUFDLEVBQ3BCLEVBQUUsR0FBRyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFDRixFQUFFO0lBQ2QsTUFBTSxTQUFTLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQTtJQUM3QixNQUFNLElBQUksR0FBRyxLQUFLLENBQUssU0FBUyxDQUFDLENBQUE7SUFFakMsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFBO0lBQ3JELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQTtJQUV0RCxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUE7SUFDZixJQUFJLENBQUMsR0FBRyxPQUFPLENBQUE7SUFFZixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUE7UUFFMUIsQ0FBQyxJQUFJLEtBQUssR0FBRyxHQUFHLENBQUE7UUFFaEIsSUFBSSxDQUFDLEdBQUcsS0FBSyxHQUFHLEtBQUssRUFBRSxDQUFDO1lBQ3RCLENBQUMsR0FBRyxPQUFPLENBQUE7WUFDWCxDQUFD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QUFDWixDQUFDLENBQUE7QUFFRCxNQUFNLENBQUMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxHQUFXLEVBQUUsR0FBVyxFQUFXLEVBQUUsQ0FDM0QsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUE7QUFFeEIsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsT0FBZ0IsRUFBTSxFQUFFO0lBQ25ELE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQTtJQUU5QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWCxNQUFNLEtBQUssQ0FBQyxxQkFBcUIsT0FBTyxFQUFFLENBQUMsQ0FBQTtJQUM3QyxDQUFDO0lBRUQsTUFBTSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQTtJQUUxQixPQUFPLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQzFDLENBQUMsQ0FBQTtBQUVELE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBRyxDQUN4QixLQUFhLEVBQUUsSUFBWSxFQUFFLEdBQUcsR0FBRyxDQUFDLEVBQUUsT0FBTyxHQUFHLENBQUMsRUFDakQsRUFBRTtJQUNGLDJDQUEyQztJQUMzQyxNQUFNLE1BQU0sR0FBRyxLQUFLLEdBQUcsR0FBRyxHQUFHLENBQUMsR0FBRyxPQUFPLENBQUE7SUFFeEMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFFLE1BQU0sR0FBRyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBRSxDQUFBO0FBQzVDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFQyIH0gZnJvbSAnLi4vdHlwZXMuanMnXG5pbXBvcnQgeyBhc3NydFBvc2l0aXZlIH0gZnJvbSAnLi4vdXRpbC5qcydcbmltcG9ydCB7IEdyaWRMYXlvdXQsIEdyaWRLZXksIE5hbWVkR3JpZExheW91dCB9IGZyb20gJy4vdHlwZXMuanMnXG5cbmV4cG9ydCBjb25zdCBnZW5lcmF0ZUdyaWRMYXlvdXQgPSAoXG4gIGNlbGxXOiBudW1iZXIsIGNlbGxIOiBudW1iZXIsXG4gIGNvbHM6IG51bWJlciwgcm93czogbnVtYmVyLFxuICBnYXAgPSAwLCBwYWRkaW5nID0gMCxcbiAgZHggPSAwLCBkeSA9IDBcbik6IEdyaWRMYXlvdXQgPT4ge1xuICBjb25zdCBjZWxsQ291bnQgPSBjb2xzICogcm93c1xuICBjb25zdCBkYXRhID0gQXJyYXk8VDI+KGNlbGxDb3VudClcblxuICBjb25zdCB3aWR0aCA9IG1lYXN1cmVDZWxscyhjZWxsVywgY29scywgZ2FwLCBwYWRkaW5nKVxuICBjb25zdCBoZWlnaHQgPSBtZWFzdXJlQ2VsbHMoY2VsbEgsIHJvd3MsIGdhcCwgcGFkZGluZylcblxuICBsZXQgeCA9IHBhZGRpbmdcbiAgbGV0IHkgPSBwYWRkaW5nXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjZWxsQ291bnQ7IGkrKykge1xuICAgIGRhdGFbaV0gPSBbeCArIGR4LCB5ICsgZHldXG5cbiAgICB4ICs9IGNlbGxXICsgZ2FwXG5cbiAgICBpZiAoeCArIGNlbGxXID4gd2lkdGgpIHtcbiAgICAgIHggPSBwYWRkaW5nXG4gICAgICB5ICs9IGNlbGxIICsgZ2FwXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjZWxsVywgY2VsbEgsIGNvbHMsIHJvd3MsIGdhcCwgcGFkZGluZywgd2lkdGgsIGhlaWdodCwgY2VsbHM6IGRhdGFcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbWVhc3VyZUNlbGxzID0gKFxuICBzaXplOiBudW1iZXIsIGNvdW50OiBudW1iZXIsIGdhcCA9IDAsIHBhZGRpbmcgPSAwXG4pID0+IFxuICBzaXplICogY291bnQgKyAoY291bnQgLSAxKSAqIGdhcCArIDIgKiBwYWRkaW5nXG5cbmV4cG9ydCBjb25zdCBnZW5lcmF0ZU5hbWVkR3JpZExheW91dCA9IChncmlkOiBHcmlkTGF5b3V0KSA9PiB7XG4gIGNvbnN0IG5hbWVkOiBOYW1lZEdyaWRMYXlvdXQgPSB7XG4gICAgLi4uZ3JpZFxuICB9XG5cbiAgZm9yIChsZXQgeSA9IDA7IHkgPCBncmlkLnJvd3M7IHkrKykge1xuICAgIGZvciAobGV0IHggPSAwOyB4IDwgZ3JpZC5jb2xzOyB4KyspIHtcbiAgICAgIG5hbWVkW2dyaWRLZXkoeCwgeSldID0gZ3JpZC5jZWxsc1t5ICogZ3JpZC5jb2xzICsgeF1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmFtZWRcbn1cblxuZXhwb3J0IGNvbnN0IGNvbEtleSA9IChjb2w6IG51bWJlcikgPT4ge1xuICBjb2wgPSBhc3NydFBvc2l0aXZlKFxuICAgIGNvbCB8IDAsICdPbmx5IHBvc2l0aXZlIGludGVnZXJzIGFyZSBhbGxvd2VkIGZvciBjb2x1bW4ga2V5cydcbiAgKVxuXG4gIGxldCBrZXkgPSAnJ1xuXG4gIGRvIHtcbiAgICBjb25zdCBtb2QgPSBjb2wgJSAyNlxuICAgIGtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoOTcgKyBtb2QpICsga2V5XG4gICAgY29sID0gTWF0aC5mbG9vcihjb2wgLyAyNikgLSAxXG4gIH0gd2hpbGUgKGNvbCA+PSAwKVxuXG4gIHJldHVybiBrZXlcbn1cblxuZXhwb3J0IGNvbnN0IHBhcnNlQ29sS2V5ID0gKGtleTogc3RyaW5nKSA9PiB7XG4gIGlmIChrZXkubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuICBpZiAoa2V5Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIGtleS5jaGFyQ29kZUF0KDApIC0gOTdcblxuICBsZXQgY29sID0gMFxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5Lmxlbmd0aCAtIDE7IGkrKykge1xuICAgIGNvbCA9IGNvbCAqIDI2ICsgKGtleS5jaGFyQ29kZUF0KGkpIC0gOTcgKyAxKVxuICB9XG5cbiAgY29sID0gY29sICogMjYgKyAoa2V5LmNoYXJDb2RlQXQoa2V5Lmxlbmd0aCAtIDEpIC0gOTcpXG5cbiAgcmV0dXJuIGNvbFxufVxuXG5leHBvcnQgY29uc3QgZ3JpZEtleSA9IChjb2w6IG51bWJlciwgcm93OiBudW1iZXIpOiBHcmlkS2V5ID0+XG4gIGAke2NvbEtleShjb2wpfSR7cm93fWBcblxuZXhwb3J0IGNvbnN0IHBhcnNlR3JpZEtleSA9IChncmlkS2V5OiBHcmlkS2V5KTogVDIgPT4ge1xuICBjb25zdCBtYXRjaCA9IGdyaWRLZXkubWF0Y2goL14oW2Etel0rKShcXGQrKSQvKVxuXG4gIGlmICghbWF0Y2gpIHtcbiAgICB0aHJvdyBFcnJvcihgSW52YWxpZCBncmlkIGtleTogJHtncmlkS2V5fWApXG4gIH1cblxuICBjb25zdCBbLCBjb2wsIHJvd10gPSBtYXRjaFxuXG4gIHJldHVybiBbcGFyc2VDb2xLZXkoY29sKSwgcGFyc2VJbnQocm93KV1cbn1cblxuZXhwb3J0IGNvbnN0IGNvdW50Q2VsbHMgPSAoXG4gIGF2YWlsOiBudW1iZXIsIGVhY2g6IG51bWJlciwgZ2FwID0gMCwgcGFkZGluZyA9IDBcbikgPT4ge1xuICAvLyByZW1vdmUgdGhlIHBhZGRpbmcgYW5kIGFkZCB0aGUgZmluYWwgZ2FwXG4gIGNvbnN0IGluc2lkZSA9IGF2YWlsICsgZ2FwIC0gMiAqIHBhZGRpbmcgIFxuXG4gIHJldHVybiBNYXRoLmZsb29yKCBpbnNpZGUgLyAoZWFjaCArIGdhcCkgKVxufSJdfQ==