import { assrtPositive } from '../util.js';
export const generateGridLayout = (cellW, cellH, cols, rows, gap = 0, padding = 0, dx = 0, dy = 0) => {
    const cellCount = cols * rows;
    const data = Array(cellCount);
    const width = measureCells(cellW, cols, gap, padding);
    const height = measureCells(cellH, rows, gap, padding);
    let x = padding;
    let y = padding;
    for (let i = 0; i < cellCount; i++) {
        data[i] = [x + dx, y + dy];
        x += cellW + gap;
        if (x + cellW > width) {
            x = padding;
            y += cellH + gap;
        }
    }
    return {
        cellW, cellH, cols, rows, gap, padding, width, height, cells: data
    };
};
export const measureCells = (size, count, gap = 0, padding = 0) => size * count + (count - 1) * gap + 2 * padding;
export const generateNamedGridLayout = (grid) => {
    const named = {
        ...grid
    };
    for (let y = 0; y < grid.rows; y++) {
        for (let x = 0; x < grid.cols; x++) {
            named[gridKey(x, y)] = grid.cells[y * grid.cols + x];
        }
    }
    return named;
};
export const colKey = (col) => {
    col = assrtPositive(col | 0, 'Only positive integers are allowed for column keys');
    let key = '';
    do {
        const mod = col % 26;
        key = String.fromCharCode(97 + mod) + key;
        col = Math.floor(col / 26) - 1;
    } while (col >= 0);
    return key;
};
export const parseColKey = (key) => {
    if (key.length === 0)
        return 0;
    if (key.length === 1)
        return key.charCodeAt(0) - 97;
    let col = 0;
    for (let i = 0; i < key.length - 1; i++) {
        col = col * 26 + (key.charCodeAt(i) - 97 + 1);
    }
    col = col * 26 + (key.charCodeAt(key.length - 1) - 97);
    return col;
};
export const gridKey = (col, row) => `${colKey(col)}${row}`;
export const parseGridKey = (gridKey) => {
    const match = gridKey.match(/^([a-z]+)(\d+)$/);
    if (!match) {
        throw Error(`Invalid grid key: ${gridKey}`);
    }
    const [, col, row] = match;
    return [parseColKey(col), parseInt(row)];
};
export const countCells = (avail, each, gap = 0, padding = 0) => {
    // remove the padding and add the final gap
    const inside = avail + gap - 2 * padding;
    return Math.floor(inside / (each + gap));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2dyaWQvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUcxQyxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyxDQUNoQyxLQUFhLEVBQUUsS0FBYSxFQUM1QixJQUFZLEVBQUUsSUFBWSxFQUMxQixHQUFHLEdBQUcsQ0FBQyxFQUFFLE9BQU8sR0FBRyxDQUFDLEVBQ3BCLEVBQUUsR0FBRyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFDRixFQUFFO0lBQ2QsTUFBTSxTQUFTLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQTtJQUM3QixNQUFNLElBQUksR0FBRyxLQUFLLENBQUssU0FBUyxDQUFDLENBQUE7SUFFakMsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFBO0lBQ3JELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQTtJQUV0RCxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUE7SUFDZixJQUFJLENBQUMsR0FBRyxPQUFPLENBQUE7SUFFZixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUE7UUFFMUIsQ0FBQyxJQUFJLEtBQUssR0FBRyxHQUFHLENBQUE7UUFFaEIsSUFBSSxDQUFDLEdBQUcsS0FBSyxHQUFHLEtBQUssRUFBRSxDQUFDO1lBQ3RCLENBQUMsR0FBRyxPQUFPLENBQUE7WUFDWCxDQUFD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QUFDWixDQUFDLENBQUE7QUFFRCxNQUFNLENBQUMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxHQUFXLEVBQUUsR0FBVyxFQUFXLEVBQUUsQ0FDM0QsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUE7QUFFeEIsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsT0FBZ0IsRUFBTSxFQUFFO0lBQ25ELE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQTtJQUU5QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWCxNQUFNLEtBQUssQ0FBQyxxQkFBcUIsT0FBTyxFQUFFLENBQUMsQ0FBQTtJQUM3QyxDQUFDO0lBRUQsTUFBTSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQTtJQUUxQixPQUFPLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQzFDLENBQUMsQ0FBQTtBQUVELE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBRyxDQUN4QixLQUFhLEVBQUUsSUFBWSxFQUFFLEdBQUcsR0FBRyxDQUFDLEVBQUUsT0FBTyxHQUFHLENBQUMsRUFDakQsRUFBRTtJQUNGLDJDQUEyQztJQUMzQyxNQUFNLE1BQU0sR0FBRyxLQUFLLEdBQUcsR0FBRyxHQUFHLENBQUMsR0FBRyxPQUFPLENBQUE7SUFFeEMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFFLE1BQU0sR0FBRyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBRSxDQUFBO0FBQzVDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFQyIH0gZnJvbSAnLi4vdHlwZXMuanMnXHJcbmltcG9ydCB7IGFzc3J0UG9zaXRpdmUgfSBmcm9tICcuLi91dGlsLmpzJ1xyXG5pbXBvcnQgeyBHcmlkTGF5b3V0LCBHcmlkS2V5LCBOYW1lZEdyaWRMYXlvdXQgfSBmcm9tICcuL3R5cGVzLmpzJ1xyXG5cclxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlR3JpZExheW91dCA9IChcclxuICBjZWxsVzogbnVtYmVyLCBjZWxsSDogbnVtYmVyLFxyXG4gIGNvbHM6IG51bWJlciwgcm93czogbnVtYmVyLFxyXG4gIGdhcCA9IDAsIHBhZGRpbmcgPSAwLFxyXG4gIGR4ID0gMCwgZHkgPSAwXHJcbik6IEdyaWRMYXlvdXQgPT4ge1xyXG4gIGNvbnN0IGNlbGxDb3VudCA9IGNvbHMgKiByb3dzXHJcbiAgY29uc3QgZGF0YSA9IEFycmF5PFQyPihjZWxsQ291bnQpXHJcblxyXG4gIGNvbnN0IHdpZHRoID0gbWVhc3VyZUNlbGxzKGNlbGxXLCBjb2xzLCBnYXAsIHBhZGRpbmcpXHJcbiAgY29uc3QgaGVpZ2h0ID0gbWVhc3VyZUNlbGxzKGNlbGxILCByb3dzLCBnYXAsIHBhZGRpbmcpXHJcblxyXG4gIGxldCB4ID0gcGFkZGluZ1xyXG4gIGxldCB5ID0gcGFkZGluZ1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGNlbGxDb3VudDsgaSsrKSB7XHJcbiAgICBkYXRhW2ldID0gW3ggKyBkeCwgeSArIGR5XVxyXG5cclxuICAgIHggKz0gY2VsbFcgKyBnYXBcclxuXHJcbiAgICBpZiAoeCArIGNlbGxXID4gd2lkdGgpIHtcclxuICAgICAgeCA9IHBhZGRpbmdcclxuICAgICAgeSArPSBjZWxsSCArIGdhcFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGNlbGxXLCBjZWxsSCwgY29scywgcm93cywgZ2FwLCBwYWRkaW5nLCB3aWR0aCwgaGVpZ2h0LCBjZWxsczogZGF0YVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IG1lYXN1cmVDZWxscyA9IChcclxuICBzaXplOiBudW1iZXIsIGNvdW50OiBudW1iZXIsIGdhcCA9IDAsIHBhZGRpbmcgPSAwXHJcbikgPT4gXHJcbiAgc2l6ZSAqIGNvdW50ICsgKGNvdW50IC0gMSkgKiBnYXAgKyAyICogcGFkZGluZ1xyXG5cclxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlTmFtZWRHcmlkTGF5b3V0ID0gKGdyaWQ6IEdyaWRMYXlvdXQpID0+IHtcclxuICBjb25zdCBuYW1lZDogTmFtZWRHcmlkTGF5b3V0ID0ge1xyXG4gICAgLi4uZ3JpZFxyXG4gIH1cclxuXHJcbiAgZm9yIChsZXQgeSA9IDA7IHkgPCBncmlkLnJvd3M7IHkrKykge1xyXG4gICAgZm9yIChsZXQgeCA9IDA7IHggPCBncmlkLmNvbHM7IHgrKykge1xyXG4gICAgICBuYW1lZFtncmlkS2V5KHgsIHkpXSA9IGdyaWQuY2VsbHNbeSAqIGdyaWQuY29scyArIHhdXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbmFtZWRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbEtleSA9IChjb2w6IG51bWJlcikgPT4ge1xyXG4gIGNvbCA9IGFzc3J0UG9zaXRpdmUoXHJcbiAgICBjb2wgfCAwLCAnT25seSBwb3NpdGl2ZSBpbnRlZ2VycyBhcmUgYWxsb3dlZCBmb3IgY29sdW1uIGtleXMnXHJcbiAgKVxyXG5cclxuICBsZXQga2V5ID0gJydcclxuXHJcbiAgZG8ge1xyXG4gICAgY29uc3QgbW9kID0gY29sICUgMjZcclxuICAgIGtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoOTcgKyBtb2QpICsga2V5XHJcbiAgICBjb2wgPSBNYXRoLmZsb29yKGNvbCAvIDI2KSAtIDFcclxuICB9IHdoaWxlIChjb2wgPj0gMClcclxuXHJcbiAgcmV0dXJuIGtleVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcGFyc2VDb2xLZXkgPSAoa2V5OiBzdHJpbmcpID0+IHtcclxuICBpZiAoa2V5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcclxuICBpZiAoa2V5Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIGtleS5jaGFyQ29kZUF0KDApIC0gOTdcclxuXHJcbiAgbGV0IGNvbCA9IDBcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXkubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICBjb2wgPSBjb2wgKiAyNiArIChrZXkuY2hhckNvZGVBdChpKSAtIDk3ICsgMSlcclxuICB9XHJcblxyXG4gIGNvbCA9IGNvbCAqIDI2ICsgKGtleS5jaGFyQ29kZUF0KGtleS5sZW5ndGggLSAxKSAtIDk3KVxyXG5cclxuICByZXR1cm4gY29sXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBncmlkS2V5ID0gKGNvbDogbnVtYmVyLCByb3c6IG51bWJlcik6IEdyaWRLZXkgPT5cclxuICBgJHtjb2xLZXkoY29sKX0ke3Jvd31gXHJcblxyXG5leHBvcnQgY29uc3QgcGFyc2VHcmlkS2V5ID0gKGdyaWRLZXk6IEdyaWRLZXkpOiBUMiA9PiB7XHJcbiAgY29uc3QgbWF0Y2ggPSBncmlkS2V5Lm1hdGNoKC9eKFthLXpdKykoXFxkKykkLylcclxuXHJcbiAgaWYgKCFtYXRjaCkge1xyXG4gICAgdGhyb3cgRXJyb3IoYEludmFsaWQgZ3JpZCBrZXk6ICR7Z3JpZEtleX1gKVxyXG4gIH1cclxuXHJcbiAgY29uc3QgWywgY29sLCByb3ddID0gbWF0Y2hcclxuXHJcbiAgcmV0dXJuIFtwYXJzZUNvbEtleShjb2wpLCBwYXJzZUludChyb3cpXVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY291bnRDZWxscyA9IChcclxuICBhdmFpbDogbnVtYmVyLCBlYWNoOiBudW1iZXIsIGdhcCA9IDAsIHBhZGRpbmcgPSAwXHJcbikgPT4ge1xyXG4gIC8vIHJlbW92ZSB0aGUgcGFkZGluZyBhbmQgYWRkIHRoZSBmaW5hbCBnYXBcclxuICBjb25zdCBpbnNpZGUgPSBhdmFpbCArIGdhcCAtIDIgKiBwYWRkaW5nICBcclxuXHJcbiAgcmV0dXJuIE1hdGguZmxvb3IoIGluc2lkZSAvIChlYWNoICsgZ2FwKSApXHJcbn0iXX0=