import { assrtPositive } from '../util.js';
export const generateGridLayout = (cellW, cellH, cols, rows, gap = 0, padding = 0) => {
    const cellCount = cols * rows;
    const data = Array(cellCount);
    const width = measureCells(cellW, cols, gap, padding);
    const height = measureCells(cellH, rows, gap, padding);
    let x = padding;
    let y = padding;
    for (let i = 0; i < cellCount; i++) {
        data[i] = [x, y];
        x += cellW + gap;
        if (x + cellW > width) {
            x = padding;
            y += cellH + gap;
        }
    }
    return {
        cellW, cellH, cols, rows, gap, padding, width, height, cells: data
    };
};
export const measureCells = (size, count, gap = 0, padding = 0) => size * count + (count - 1) * gap + 2 * padding;
export const generateNamedGridLayout = (grid) => {
    const named = {
        ...grid
    };
    for (let y = 0; y < grid.rows; y++) {
        for (let x = 0; x < grid.cols; x++) {
            named[gridKey(x, y)] = grid.cells[y * grid.cols + x];
        }
    }
    return named;
};
export const colKey = (col) => {
    col = assrtPositive(col | 0, 'Only positive integers are allowed for column keys');
    let key = '';
    do {
        const mod = col % 26;
        key = String.fromCharCode(97 + mod) + key;
        col = Math.floor(col / 26) - 1;
    } while (col >= 0);
    return key;
};
export const parseColKey = (key) => {
    if (key.length === 0)
        return 0;
    if (key.length === 1)
        return key.charCodeAt(0) - 97;
    let col = 0;
    for (let i = 0; i < key.length - 1; i++) {
        col = col * 26 + (key.charCodeAt(i) - 97 + 1);
    }
    col = col * 26 + (key.charCodeAt(key.length - 1) - 97);
    return col;
};
export const gridKey = (col, row) => `${colKey(col)}${row}`;
export const parseGridKey = (gridKey) => {
    const match = gridKey.match(/^([a-z]+)(\d+)$/);
    if (!match) {
        throw Error(`Invalid grid key: ${gridKey}`);
    }
    const [, col, row] = match;
    return [parseColKey(col), parseInt(row)];
};
export const countCells = (avail, each, gap = 0, padding = 0) => {
    // remove the padding and add the final gap
    const inside = avail + gap - 2 * padding;
    return Math.floor(inside / (each + gap));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2dyaWQvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUcxQyxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyxDQUNoQyxLQUFhLEVBQUUsS0FBYSxFQUM1QixJQUFZLEVBQUUsSUFBWSxFQUMxQixHQUFHLEdBQUcsQ0FBQyxFQUFFLE9BQU8sR0FBRyxDQUFDLEVBQ1IsRUFBRTtJQUNkLE1BQU0sU0FBUyxHQUFHLElBQUksR0FBRyxJQUFJLENBQUE7SUFDN0IsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFLLFNBQVMsQ0FBQyxDQUFBO0lBRWpDLE1BQU0sS0FBSyxHQUFHLFlBQVksQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQTtJQUNyRCxNQUFNLE1BQU0sR0FBRyxZQUFZLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUE7SUFFdEQsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFBO0lBQ2YsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFBO0lBRWYsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtRQUVoQixDQUFDLElBQUksS0FBSyxHQUFHLEdBQUcsQ0FBQTtRQUVoQixJQUFJLENBQUMsR0FBRyxLQUFLLEdBQUcsS0FBSyxFQUFFLENBQUM7WUFDdEIsQ0FBQyxHQUFHLE9BQU8sQ0FBQTtZQUNYLENBQUMsSUFBSSxLQUFLLEdBQUcsR0FBRyxDQUFBO1FBQ2xCLENBQUM7SUFDSCxDQUFDO0lBRUQsT0FBTztRQUNM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QUFXLEVBQVcsRUFBRSxDQUMzRCxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQTtBQUV4QixNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxPQUFnQixFQUFNLEVBQUU7SUFDbkQsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO0lBRTlDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNYLE1BQU0sS0FBSyxDQUFDLHFCQUFxQixPQUFPLEVBQUUsQ0FBQyxDQUFBO0lBQzdDLENBQUM7SUFFRCxNQUFNLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFBO0lBRTFCLE9BQU8sQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEVBQUUsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7QUFDMUMsQ0FBQyxDQUFBO0FBRUQsTUFBTSxDQUFDLE1BQU0sVUFBVSxHQUFHLENBQ3hCLEtBQWEsRUFBRSxJQUFZLEVBQUUsR0FBRyxHQUFHLENBQUMsRUFBRSxPQUFPLEdBQUcsQ0FBQyxFQUNqRCxFQUFFO0lBQ0YsMkNBQTJDO0lBQzNDLE1BQU0sTUFBTSxHQUFHLEtBQUssR0FBRyxHQUFHLEdBQUcsQ0FBQyxHQUFHLE9BQU8sQ0FBQTtJQUV4QyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUUsTUFBTSxHQUFHLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFFLENBQUE7QUFDNUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVDIgfSBmcm9tICcuLi90eXBlcy5qcydcclxuaW1wb3J0IHsgYXNzcnRQb3NpdGl2ZSB9IGZyb20gJy4uL3V0aWwuanMnXHJcbmltcG9ydCB7IEdyaWRMYXlvdXQsIEdyaWRLZXksIE5hbWVkR3JpZExheW91dCB9IGZyb20gJy4vdHlwZXMuanMnXHJcblxyXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVHcmlkTGF5b3V0ID0gKFxyXG4gIGNlbGxXOiBudW1iZXIsIGNlbGxIOiBudW1iZXIsXHJcbiAgY29sczogbnVtYmVyLCByb3dzOiBudW1iZXIsXHJcbiAgZ2FwID0gMCwgcGFkZGluZyA9IDBcclxuKTogR3JpZExheW91dCA9PiB7XHJcbiAgY29uc3QgY2VsbENvdW50ID0gY29scyAqIHJvd3NcclxuICBjb25zdCBkYXRhID0gQXJyYXk8VDI+KGNlbGxDb3VudClcclxuXHJcbiAgY29uc3Qgd2lkdGggPSBtZWFzdXJlQ2VsbHMoY2VsbFcsIGNvbHMsIGdhcCwgcGFkZGluZylcclxuICBjb25zdCBoZWlnaHQgPSBtZWFzdXJlQ2VsbHMoY2VsbEgsIHJvd3MsIGdhcCwgcGFkZGluZylcclxuXHJcbiAgbGV0IHggPSBwYWRkaW5nXHJcbiAgbGV0IHkgPSBwYWRkaW5nXHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2VsbENvdW50OyBpKyspIHtcclxuICAgIGRhdGFbaV0gPSBbeCwgeV1cclxuXHJcbiAgICB4ICs9IGNlbGxXICsgZ2FwXHJcblxyXG4gICAgaWYgKHggKyBjZWxsVyA+IHdpZHRoKSB7XHJcbiAgICAgIHggPSBwYWRkaW5nXHJcbiAgICAgIHkgKz0gY2VsbEggKyBnYXBcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBjZWxsVywgY2VsbEgsIGNvbHMsIHJvd3MsIGdhcCwgcGFkZGluZywgd2lkdGgsIGhlaWdodCwgY2VsbHM6IGRhdGFcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBtZWFzdXJlQ2VsbHMgPSAoXHJcbiAgc2l6ZTogbnVtYmVyLCBjb3VudDogbnVtYmVyLCBnYXAgPSAwLCBwYWRkaW5nID0gMFxyXG4pID0+IFxyXG4gIHNpemUgKiBjb3VudCArIChjb3VudCAtIDEpICogZ2FwICsgMiAqIHBhZGRpbmdcclxuXHJcbmV4cG9ydCBjb25zdCBnZW5lcmF0ZU5hbWVkR3JpZExheW91dCA9IChncmlkOiBHcmlkTGF5b3V0KSA9PiB7XHJcbiAgY29uc3QgbmFtZWQ6IE5hbWVkR3JpZExheW91dCA9IHtcclxuICAgIC4uLmdyaWRcclxuICB9XHJcblxyXG4gIGZvciAobGV0IHkgPSAwOyB5IDwgZ3JpZC5yb3dzOyB5KyspIHtcclxuICAgIGZvciAobGV0IHggPSAwOyB4IDwgZ3JpZC5jb2xzOyB4KyspIHtcclxuICAgICAgbmFtZWRbZ3JpZEtleSh4LCB5KV0gPSBncmlkLmNlbGxzW3kgKiBncmlkLmNvbHMgKyB4XVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIG5hbWVkXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjb2xLZXkgPSAoY29sOiBudW1iZXIpID0+IHtcclxuICBjb2wgPSBhc3NydFBvc2l0aXZlKFxyXG4gICAgY29sIHwgMCwgJ09ubHkgcG9zaXRpdmUgaW50ZWdlcnMgYXJlIGFsbG93ZWQgZm9yIGNvbHVtbiBrZXlzJ1xyXG4gIClcclxuXHJcbiAgbGV0IGtleSA9ICcnXHJcblxyXG4gIGRvIHtcclxuICAgIGNvbnN0IG1vZCA9IGNvbCAlIDI2XHJcbiAgICBrZXkgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDk3ICsgbW9kKSArIGtleVxyXG4gICAgY29sID0gTWF0aC5mbG9vcihjb2wgLyAyNikgLSAxXHJcbiAgfSB3aGlsZSAoY29sID49IDApXHJcblxyXG4gIHJldHVybiBrZXlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHBhcnNlQ29sS2V5ID0gKGtleTogc3RyaW5nKSA9PiB7XHJcbiAgaWYgKGtleS5sZW5ndGggPT09IDApIHJldHVybiAwXHJcbiAgaWYgKGtleS5sZW5ndGggPT09IDEpIHJldHVybiBrZXkuY2hhckNvZGVBdCgwKSAtIDk3XHJcblxyXG4gIGxldCBjb2wgPSAwXHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5Lmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgY29sID0gY29sICogMjYgKyAoa2V5LmNoYXJDb2RlQXQoaSkgLSA5NyArIDEpXHJcbiAgfVxyXG5cclxuICBjb2wgPSBjb2wgKiAyNiArIChrZXkuY2hhckNvZGVBdChrZXkubGVuZ3RoIC0gMSkgLSA5NylcclxuXHJcbiAgcmV0dXJuIGNvbFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ3JpZEtleSA9IChjb2w6IG51bWJlciwgcm93OiBudW1iZXIpOiBHcmlkS2V5ID0+XHJcbiAgYCR7Y29sS2V5KGNvbCl9JHtyb3d9YFxyXG5cclxuZXhwb3J0IGNvbnN0IHBhcnNlR3JpZEtleSA9IChncmlkS2V5OiBHcmlkS2V5KTogVDIgPT4ge1xyXG4gIGNvbnN0IG1hdGNoID0gZ3JpZEtleS5tYXRjaCgvXihbYS16XSspKFxcZCspJC8pXHJcblxyXG4gIGlmICghbWF0Y2gpIHtcclxuICAgIHRocm93IEVycm9yKGBJbnZhbGlkIGdyaWQga2V5OiAke2dyaWRLZXl9YClcclxuICB9XHJcblxyXG4gIGNvbnN0IFssIGNvbCwgcm93XSA9IG1hdGNoXHJcblxyXG4gIHJldHVybiBbcGFyc2VDb2xLZXkoY29sKSwgcGFyc2VJbnQocm93KV1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvdW50Q2VsbHMgPSAoXHJcbiAgYXZhaWw6IG51bWJlciwgZWFjaDogbnVtYmVyLCBnYXAgPSAwLCBwYWRkaW5nID0gMFxyXG4pID0+IHtcclxuICAvLyByZW1vdmUgdGhlIHBhZGRpbmcgYW5kIGFkZCB0aGUgZmluYWwgZ2FwXHJcbiAgY29uc3QgaW5zaWRlID0gYXZhaWwgKyBnYXAgLSAyICogcGFkZGluZyAgXHJcblxyXG4gIHJldHVybiBNYXRoLmZsb29yKCBpbnNpZGUgLyAoZWFjaCArIGdhcCkgKVxyXG59Il19