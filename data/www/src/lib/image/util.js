export const clampTransfer = (srcW, srcH, destW, destH, transfer) => {
    let [sx, sy, sw, sh, dx, dy] = transfer;
    if (sx < 0) {
        sw += sx;
        dx -= sx;
        sx = 0;
    }
    if (sy < 0) {
        sh += sy;
        dy -= sy;
        sy = 0;
    }
    if (sx + sw > srcW) {
        sw = srcW - sx;
    }
    if (sy + sh > srcH) {
        sh = srcH - sy;
    }
    if (dx < 0) {
        sw += dx;
        sx -= dx;
        dx = 0;
    }
    if (dy < 0) {
        sh += dy;
        sy -= dy;
        dy = 0;
    }
    if (dx + sw > destW) {
        sw = destW - dx;
    }
    if (dy + sh > destH) {
        sh = destH - dy;
    }
    if (sw < 0)
        sw = 0;
    if (sh < 0)
        sh = 0;
    return [sx, sy, sw, sh, dx, dy];
};
export const clampRect = (srcW, srcH, rect) => {
    let [x, y, w, h] = rect;
    if (x < 0) {
        w += x;
        x = 0;
    }
    if (y < 0) {
        h += y;
        y = 0;
    }
    if (x + w > srcW) {
        w = srcW - x;
    }
    if (y + h > srcH) {
        h = srcH - y;
    }
    if (w < 0)
        w = 0;
    if (h < 0)
        h = 0;
    return [x, y, w, h];
};
export const clampRows = (rows, w, h) => rows.reduce((acc, [y, x0, x1, ...args]) => {
    if (y < 0 || y >= h)
        return acc;
    let x0c = Math.max(x0, 0);
    let x1c = Math.min(x1, w);
    if (x0c > x1c)
        return acc;
    acc.push([y, x0c, x1c, ...args]);
    return acc;
}, []);
export const clampRow = (row, w, h) => {
    const [y, x0, x1, ...args] = row;
    if (y < 0 || y >= h)
        return null;
    let x0c = Math.max(x0, 0);
    let x1c = Math.min(x1, w);
    if (x0c > x1c)
        return null;
    return [y, x0c, x1c, ...args];
};
export const pointsToIndices = (w, h, channels) => (points) => points.reduce((acc, [x, y]) => {
    if (x < 0 || x >= w || y < 0 || y >= h)
        return acc;
    acc.push((y * w + x) * channels);
    return acc;
}, []);
export const pset = (image, x, y, color) => {
    const view = new Uint32Array(image.data.buffer);
    const index = y * image.width + x;
    view[index] = color;
};
export const pget = (image, x, y) => {
    const view = new Uint32Array(image.data.buffer);
    const index = y * image.width + x;
    return view[index];
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvaW1hZ2UvdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxNQUFNLENBQUMsTUFBTSxhQUFhLEdBQUcsQ0FDM0IsSUFBWSxFQUFFLElBQVksRUFBRSxLQUFhLEVBQUUsS0FBYSxFQUN4RCxRQUFZLEVBQ1IsRUFBRTtJQUNOLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxHQUFHLFFBQVEsQ0FBQTtJQUV2QyxJQUFJLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUNYLEVBQUUsSUFBSSxFQUFFLENBQUE7UUFDUixFQUFFLElBQUksRUFBRSxDQUFBO1FBQ1IsRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUNSLENBQUM7SUFFRCxJQUFJLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUNYLEVBQUUsSUFBSSxFQUFFLENBQUE7UUFDUixFQUFFLElBQUksRUFBRSxDQUFBO1FBQ1IsRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUNSLENBQUM7SUFFRCxJQUFJLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxFQUFFLENBQUM7UUFDbkIsRUFBRSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUE7SUFDaEIsQ0FBQztJQUVELElBQUksRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLEVBQUUsQ0FBQztRQUNuQixFQUFFLEdBQUcsSUFBSSxHQUFHLEVBQUUsQ0FBQTtJQUNoQixDQUFDO0lBRUQsSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDWCxFQUFFLElBQUksRUFBRSxDQUFBO1FBQ1IsRUFBRSxJQUFJLEVBQUUsQ0FBQTtRQUNSLEVBQUUsR0FBRyxDQUFDLENBQUE7SUFDUixDQUFDO0lBRUQsSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDWCxFQUFFLElBQUksRUFB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SyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQTtJQUMvQyxNQUFNLEtBQUssR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUE7SUFFakMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQTtBQUNyQixDQUFDLENBQUE7QUFFRCxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsQ0FBQyxLQUFnQixFQUFFLENBQVMsRUFBRSxDQUFTLEVBQUUsRUFBRTtJQUM3RCxNQUFNLElBQUksR0FBRyxJQUFJLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQy9DLE1BQU0sS0FBSyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQTtJQUVqQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNwQixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3cgfSBmcm9tICcuL3R5cGVzLmpzJ1xuaW1wb3J0IHsgVDIsIFQ0LCBUNiB9IGZyb20gJy4uL3R5cGVzLmpzJ1xuXG5leHBvcnQgY29uc3QgY2xhbXBUcmFuc2ZlciA9IChcbiAgc3JjVzogbnVtYmVyLCBzcmNIOiBudW1iZXIsIGRlc3RXOiBudW1iZXIsIGRlc3RIOiBudW1iZXIsXG4gIHRyYW5zZmVyOiBUNlxuKTogVDYgPT4ge1xuICBsZXQgW3N4LCBzeSwgc3csIHNoLCBkeCwgZHldID0gdHJhbnNmZXJcblxuICBpZiAoc3ggPCAwKSB7XG4gICAgc3cgKz0gc3hcbiAgICBkeCAtPSBzeFxuICAgIHN4ID0gMFxuICB9XG5cbiAgaWYgKHN5IDwgMCkge1xuICAgIHNoICs9IHN5XG4gICAgZHkgLT0gc3lcbiAgICBzeSA9IDBcbiAgfVxuXG4gIGlmIChzeCArIHN3ID4gc3JjVykge1xuICAgIHN3ID0gc3JjVyAtIHN4XG4gIH1cblxuICBpZiAoc3kgKyBzaCA+IHNyY0gpIHtcbiAgICBzaCA9IHNyY0ggLSBzeVxuICB9XG5cbiAgaWYgKGR4IDwgMCkge1xuICAgIHN3ICs9IGR4XG4gICAgc3ggLT0gZHhcbiAgICBkeCA9IDBcbiAgfVxuXG4gIGlmIChkeSA8IDApIHtcbiAgICBzaCArPSBkeVxuICAgIHN5IC09IGR5XG4gICAgZHkgPSAwXG4gIH1cblxuICBpZiAoZHggKyBzdyA+IGRlc3RXKSB7XG4gICAgc3cgPSBkZXN0VyAtIGR4XG4gIH1cblxuICBpZiAoZHkgKyBzaCA+IGRlc3RIKSB7XG4gICAgc2ggPSBkZXN0SCAtIGR5XG4gIH1cblxuICBpZiAoc3cgPCAwKSBzdyA9IDBcbiAgaWYgKHNoIDwgMCkgc2ggPSAwXG5cbiAgcmV0dXJuIFtzeCwgc3ksIHN3LCBzaCwgZHgsIGR5XVxufVxuXG5leHBvcnQgY29uc3QgY2xhbXBSZWN0ID0gKHNyY1c6IG51bWJlciwgc3JjSDogbnVtYmVyLCByZWN0OiBUNCk6IFQ0ID0+IHtcbiAgbGV0IFt4LCB5LCB3LCBoXSA9IHJlY3RcblxuICBpZiAoeCA8IDApIHtcbiAgICB3ICs9IHhcbiAgICB4ID0gMFxuICB9XG5cbiAgaWYgKHkgPCAwKSB7XG4gICAgaCArPSB5XG4gICAgeSA9IDBcbiAgfVxuXG4gIGlmICh4ICsgdyA+IHNyY1cpIHtcbiAgICB3ID0gc3JjVyAtIHhcbiAgfVxuXG4gIGlmICh5ICsgaCA+IHNyY0gpIHtcbiAgICBoID0gc3JjSCAtIHlcbiAgfVxuXG4gIGlmICh3IDwgMCkgdyA9IDBcbiAgaWYgKGggPCAwKSBoID0gMFxuXG4gIHJldHVybiBbeCwgeSwgdywgaF1cbn1cblxuZXhwb3J0IGNvbnN0IGNsYW1wUm93cyA9IDxBcmc+KHJvd3M6IFJvdzxBcmc+W10sIHc6IG51bWJlciwgaDogbnVtYmVyKSA9PlxuICByb3dzLnJlZHVjZSgoYWNjLCBbeSwgeDAsIHgxLCAuLi5hcmdzXSkgPT4ge1xuICAgIGlmICh5IDwgMCB8fCB5ID49IGgpIHJldHVybiBhY2NcblxuICAgIGxldCB4MGMgPSBNYXRoLm1heCh4MCwgMClcbiAgICBsZXQgeDFjID0gTWF0aC5taW4oeDEsIHcpXG5cbiAgICBpZiAoeDBjID4geDFjKSByZXR1cm4gYWNjXG5cbiAgICBhY2MucHVzaChbeSwgeDBjLCB4MWMsIC4uLmFyZ3NdKVxuXG4gICAgcmV0dXJuIGFjY1xuICB9LCBbXSBhcyBSb3c8QXJnPltdKVxuXG5leHBvcnQgY29uc3QgY2xhbXBSb3cgPSA8QXJnPihyb3c6IFJvdzxBcmc+LCB3OiBudW1iZXIsIGg6IG51bWJlcikgPT4ge1xuICBjb25zdCBbeSwgeDAsIHgxLCAuLi5hcmdzXSA9IHJvd1xuXG4gIGlmICh5IDwgMCB8fCB5ID49IGgpIHJldHVybiBudWxsXG5cbiAgbGV0IHgwYyA9IE1hdGgubWF4KHgwLCAwKVxuICBsZXQgeDFjID0gTWF0aC5taW4oeDEsIHcpXG5cbiAgaWYgKHgwYyA+IHgxYykgcmV0dXJuIG51bGxcblxuICByZXR1cm4gW3ksIHgwYywgeDFjLCAuLi5hcmdzXSBhcyBSb3c8QXJnPlxufVxuXG5cbmV4cG9ydCBjb25zdCBwb2ludHNUb0luZGljZXMgPSAodzogbnVtYmVyLCBoOiBudW1iZXIsIGNoYW5uZWxzOiBudW1iZXIpID0+XG4gIChwb2ludHM6IFQyW10pID0+XG4gICAgcG9pbnRzLnJlZHVjZSgoYWNjLCBbeCwgeV0pID0+IHtcbiAgICAgIGlmICh4IDwgMCB8fCB4ID49IHcgfHwgeSA8IDAgfHwgeSA+PSBoKSByZXR1cm4gYWNjXG5cbiAgICAgIGFjYy5wdXNoKCh5ICogdyArIHgpICogY2hhbm5lbHMpXG5cbiAgICAgIHJldHVybiBhY2NcbiAgICB9LCBbXSBhcyBudW1iZXJbXSlcblxuXG5leHBvcnQgY29uc3QgcHNldCA9IChcbiAgaW1hZ2U6IEltYWdlRGF0YSwgeDogbnVtYmVyLCB5OiBudW1iZXIsIGNvbG9yOiBudW1iZXJcbikgPT4ge1xuICBjb25zdCB2aWV3ID0gbmV3IFVpbnQzMkFycmF5KGltYWdlLmRhdGEuYnVmZmVyKVxuICBjb25zdCBpbmRleCA9IHkgKiBpbWFnZS53aWR0aCArIHhcblxuICB2aWV3W2luZGV4XSA9IGNvbG9yXG59XG5cbmV4cG9ydCBjb25zdCBwZ2V0ID0gKGltYWdlOiBJbWFnZURhdGEsIHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IHZpZXcgPSBuZXcgVWludDMyQXJyYXkoaW1hZ2UuZGF0YS5idWZmZXIpXG4gIGNvbnN0IGluZGV4ID0geSAqIGltYWdlLndpZHRoICsgeFxuXG4gIHJldHVybiB2aWV3W2luZGV4XVxufVxuIl19