import { assrt, assrtPositive } from '../util.js';
// returns a structure representing the top left of each cell in the grid
// the last entry is the total width and height of the grid, previous entries 
// are the top left of each cell in the grid
export const generateGrid = (cellW, cellH, cols, rows, gap = 0, padding = 0) => {
    const cellCount = cols * rows;
    const data = Array(cellCount + 1);
    const gridW = cols * cellW + (cols - 1) * gap + 2 * padding;
    const gridH = rows * cellH + (rows - 1) * gap + 2 * padding;
    let x = padding;
    let y = padding;
    for (let i = 0; i < cellCount; i++) {
        data[i] = [x, y];
        x += cellW + gap;
        if (x + cellW > gridW) {
            x = padding;
            y += cellH + gap;
        }
    }
    data[cellCount] = [gridW, gridH];
    return data;
};
export const generateNamedGrid = (cellW, cellH, cols, rows, gap = 0, padding = 0) => {
    const grid = generateGrid(cellW, cellH, cols, rows, gap, padding);
    const [width, height] = assrt(grid.pop());
    const named = {
        width, height
    };
    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols; x++) {
            const key = gridKey(x, y);
            const [gx, gy] = grid[y * cols + x];
            named[key] = [gx, gy];
        }
    }
    return named;
};
export const colKey = (col) => {
    col = assrtPositive(col | 0, 'Only positive integers are allowed for column keys');
    let key = '';
    do {
        const mod = col % 26;
        key = String.fromCharCode(97 + mod) + key;
        col = Math.floor(col / 26) - 1;
    } while (col >= 0);
    return key;
};
export const parseColKey = (key) => {
    if (key.length === 0)
        return 0;
    if (key.length === 1)
        return key.charCodeAt(0) - 97;
    let col = 0;
    for (let i = 0; i < key.length - 1; i++) {
        col = col * 26 + (key.charCodeAt(i) - 97 + 1);
    }
    col = col * 26 + (key.charCodeAt(key.length - 1) - 97);
    return col;
};
// column names are a..z, aa..az, ba..bz, etc
// row names are 0..n
export const gridKey = (col, row) => `${colKey(col)}${row}`;
export const parseGridKey = (gridKey) => {
    const match = gridKey.match(/([a-z]+)(\d+)/);
    if (!match) {
        throw Error(`Invalid grid key: ${gridKey}`);
    }
    const [, col, row] = match;
    return [parseColKey(col), parseInt(row)];
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvZ2VvbWV0cnkvZ3JpZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsS0FBSyxFQUFFLGFBQWEsRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUdqRCx5RUFBeUU7QUFDekUsOEVBQThFO0FBQzlFLDRDQUE0QztBQUM1QyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsQ0FDMUIsS0FBYSxFQUFFLEtBQWEsRUFDNUIsSUFBWSxFQUFFLElBQVksRUFDMUIsR0FBRyxHQUFHLENBQUMsRUFBRSxPQUFPLEdBQUcsQ0FBQyxFQUNkLEVBQUU7SUFDUixNQUFNLFNBQVMsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFBO0lBQzdCLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBSyxTQUFTLEdBQUcsQ0FBQyxDQUFDLENBQUE7SUFFckMsTUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLEtBQUssR0FBRyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxHQUFHLE9BQU8sQ0FBQTtJQUMzRCxNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsS0FBSyxHQUFHLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsT0FBTyxDQUFBO0lBRTNELElBQUksQ0FBQyxHQUFHLE9BQU8sQ0FBQTtJQUNmLElBQUksQ0FBQyxHQUFHLE9BQU8sQ0FBQTtJQUVmLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNuQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFFaEIsQ0FBQyxJQUFJLEtBQUssR0FBRyxHQUFHLENBQUE7UUFFaEIsSUFBSSxDQUFDLEdBQUcsS0FBSyxHQUFHLEtB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QUFDO0lBRUQsR0FBRyxHQUFHLEdBQUcsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUE7SUFFdEQsT0FBTyxHQUFHLENBQUE7QUFDWixDQUFDLENBQUE7QUFFRCw2Q0FBNkM7QUFDN0MscUJBQXFCO0FBQ3JCLE1BQU0sQ0FBQyxNQUFNLE9BQU8sR0FBRyxDQUFDLEdBQVcsRUFBRSxHQUFXLEVBQVcsRUFBRSxDQUMzRCxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQTtBQUV4QixNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsQ0FBRSxPQUFnQixFQUFPLEVBQUU7SUFDckQsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQTtJQUU1QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWCxNQUFNLEtBQUssQ0FBQyxxQkFBcUIsT0FBTyxFQUFFLENBQUMsQ0FBQTtJQUM3QyxDQUFDO0lBRUQsTUFBTSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBRSxHQUFHLEtBQUssQ0FBQTtJQUUzQixPQUFPLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQzFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFQyIH0gZnJvbSAnLi4vdHlwZXMuanMnXHJcbmltcG9ydCB7IGFzc3J0LCBhc3NydFBvc2l0aXZlIH0gZnJvbSAnLi4vdXRpbC5qcydcclxuaW1wb3J0IHsgR3JpZEtleSwgTmFtZWRHcmlkIH0gZnJvbSAnLi90eXBlcy5qcydcclxuXHJcbi8vIHJldHVybnMgYSBzdHJ1Y3R1cmUgcmVwcmVzZW50aW5nIHRoZSB0b3AgbGVmdCBvZiBlYWNoIGNlbGwgaW4gdGhlIGdyaWRcclxuLy8gdGhlIGxhc3QgZW50cnkgaXMgdGhlIHRvdGFsIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIGdyaWQsIHByZXZpb3VzIGVudHJpZXMgXHJcbi8vIGFyZSB0aGUgdG9wIGxlZnQgb2YgZWFjaCBjZWxsIGluIHRoZSBncmlkXHJcbmV4cG9ydCBjb25zdCBnZW5lcmF0ZUdyaWQgPSAoXHJcbiAgY2VsbFc6IG51bWJlciwgY2VsbEg6IG51bWJlcixcclxuICBjb2xzOiBudW1iZXIsIHJvd3M6IG51bWJlcixcclxuICBnYXAgPSAwLCBwYWRkaW5nID0gMFxyXG4pOiBUMltdID0+IHtcclxuICBjb25zdCBjZWxsQ291bnQgPSBjb2xzICogcm93c1xyXG4gIGNvbnN0IGRhdGEgPSBBcnJheTxUMj4oY2VsbENvdW50ICsgMSlcclxuXHJcbiAgY29uc3QgZ3JpZFcgPSBjb2xzICogY2VsbFcgKyAoY29scyAtIDEpICogZ2FwICsgMiAqIHBhZGRpbmdcclxuICBjb25zdCBncmlkSCA9IHJvd3MgKiBjZWxsSCArIChyb3dzIC0gMSkgKiBnYXAgKyAyICogcGFkZGluZ1xyXG5cclxuICBsZXQgeCA9IHBhZGRpbmdcclxuICBsZXQgeSA9IHBhZGRpbmdcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjZWxsQ291bnQ7IGkrKykge1xyXG4gICAgZGF0YVtpXSA9IFt4LCB5XVxyXG5cclxuICAgIHggKz0gY2VsbFcgKyBnYXBcclxuXHJcbiAgICBpZiAoeCArIGNlbGxXID4gZ3JpZFcpIHtcclxuICAgICAgeCA9IHBhZGRpbmdcclxuICAgICAgeSArPSBjZWxsSCArIGdhcFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGF0YVtjZWxsQ291bnRdID0gW2dyaWRXLCBncmlkSF1cclxuXHJcbiAgcmV0dXJuIGRhdGFcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlTmFtZWRHcmlkID0gKFxyXG4gIGNlbGxXOiBudW1iZXIsIGNlbGxIOiBudW1iZXIsXHJcbiAgY29sczogbnVtYmVyLCByb3dzOiBudW1iZXIsXHJcbiAgZ2FwID0gMCwgcGFkZGluZyA9IDBcclxuKSA9PiB7XHJcbiAgY29uc3QgZ3JpZCA9IGdlbmVyYXRlR3JpZChjZWxsVywgY2VsbEgsIGNvbHMsIHJvd3MsIGdhcCwgcGFkZGluZylcclxuICBjb25zdCBbd2lkdGgsIGhlaWdodF0gPSBhc3NydChncmlkLnBvcCgpKVxyXG5cclxuICBjb25zdCBuYW1lZDogTmFtZWRHcmlkID0ge1xyXG4gICAgd2lkdGgsIGhlaWdodFxyXG4gIH1cclxuXHJcbiAgZm9yKCBsZXQgeSA9IDA7IHkgPCByb3dzOyB5KysgKSB7XHJcbiAgICBmb3IoIGxldCB4ID0gMDsgeCA8IGNvbHM7IHgrKyApIHtcclxuICAgICAgY29uc3Qga2V5ID0gZ3JpZEtleSh4LCB5KVxyXG4gICAgICBjb25zdCBbZ3gsIGd5XSA9IGdyaWRbeSAqIGNvbHMgKyB4XVxyXG4gICAgICBcclxuICAgICAgbmFtZWRba2V5XSA9IFtneCwgZ3ldXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbmFtZWRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbEtleSA9IChjb2w6IG51bWJlcikgPT4ge1xyXG4gIGNvbCA9IGFzc3J0UG9zaXRpdmUoXHJcbiAgICBjb2wgfCAwLCAnT25seSBwb3NpdGl2ZSBpbnRlZ2VycyBhcmUgYWxsb3dlZCBmb3IgY29sdW1uIGtleXMnXHJcbiAgKVxyXG5cclxuICBsZXQga2V5ID0gJydcclxuXHJcbiAgZG8ge1xyXG4gICAgY29uc3QgbW9kID0gY29sICUgMjZcclxuICAgIGtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoOTcgKyBtb2QpICsga2V5XHJcbiAgICBjb2wgPSBNYXRoLmZsb29yKGNvbCAvIDI2KSAtIDFcclxuICB9IHdoaWxlIChjb2wgPj0gMClcclxuXHJcbiAgcmV0dXJuIGtleVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcGFyc2VDb2xLZXkgPSAoa2V5OiBzdHJpbmcpID0+IHtcclxuICBpZiAoa2V5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcclxuICBpZiAoa2V5Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIGtleS5jaGFyQ29kZUF0KDApIC0gOTdcclxuXHJcbiAgbGV0IGNvbCA9IDBcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXkubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICBjb2wgPSBjb2wgKiAyNiArIChrZXkuY2hhckNvZGVBdChpKSAtIDk3ICsgMSlcclxuICB9XHJcblxyXG4gIGNvbCA9IGNvbCAqIDI2ICsgKGtleS5jaGFyQ29kZUF0KGtleS5sZW5ndGggLSAxKSAtIDk3KVxyXG5cclxuICByZXR1cm4gY29sXHJcbn1cclxuXHJcbi8vIGNvbHVtbiBuYW1lcyBhcmUgYS4ueiwgYWEuLmF6LCBiYS4uYnosIGV0Y1xyXG4vLyByb3cgbmFtZXMgYXJlIDAuLm5cclxuZXhwb3J0IGNvbnN0IGdyaWRLZXkgPSAoY29sOiBudW1iZXIsIHJvdzogbnVtYmVyKTogR3JpZEtleSA9PlxyXG4gIGAke2NvbEtleShjb2wpfSR7cm93fWBcclxuXHJcbmV4cG9ydCBjb25zdCBwYXJzZUdyaWRLZXkgPSAoIGdyaWRLZXk6IEdyaWRLZXkgKTogVDIgPT4ge1xyXG4gIGNvbnN0IG1hdGNoID0gZ3JpZEtleS5tYXRjaCgvKFthLXpdKykoXFxkKykvKVxyXG5cclxuICBpZiAoIW1hdGNoKSB7XHJcbiAgICB0aHJvdyBFcnJvcihgSW52YWxpZCBncmlkIGtleTogJHtncmlkS2V5fWApXHJcbiAgfVxyXG5cclxuICBjb25zdCBbLCBjb2wsIHJvdyBdID0gbWF0Y2hcclxuXHJcbiAgcmV0dXJuIFtwYXJzZUNvbEtleShjb2wpLCBwYXJzZUludChyb3cpXVxyXG59Il19